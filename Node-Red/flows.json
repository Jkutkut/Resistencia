[{"id":"3ee4a50f.d7fd0a","type":"tab","label":"DataBase","disabled":false,"info":""},{"id":"e024e963.c4ad88","type":"http in","z":"3ee4a50f.d7fd0a","name":"","url":"/createPlayer.php","method":"post","upload":true,"swaggerDoc":"","x":140,"y":360,"wires":[["991c8d.2321337"]]},{"id":"c749d650.a0bfb8","type":"sqlite","z":"3ee4a50f.d7fd0a","mydb":"a5762d7.f21efd","sqlquery":"fixed","sql":"CREATE TABLE 'Players' (\n\t'pId' INTEGER PRIMARY KEY AUTOINCREMENT,\n\t'name' VARCHAR,\n\t'groupPos' INT DEFAULT NULL,\n\t'imgId' INT DEFAULT NULL,\n\t'pType' INT DEFAULT NULL\n);\n","name":"Create Players table","x":306,"y":58,"wires":[["e7ed17ba.a6a948"]]},{"id":"e60b12c1.93bb3","type":"inject","z":"3ee4a50f.d7fd0a","name":"","props":[{"p":"payload","v":"Started!","vt":"str"},{"p":"topic","v":"","vt":"string"}],"repeat":"","crontab":"","once":true,"topic":"","payload":"Started!","payloadType":"str","x":126,"y":58,"wires":[["c749d650.a0bfb8"]]},{"id":"32422764.0b24c8","type":"sqlite","z":"3ee4a50f.d7fd0a","mydb":"a5762d7.f21efd","sqlquery":"msg.topic","sql":"INSERT INTO Players ('name') values (\"Jorge\");","name":"Add playerName to Players table","x":820,"y":360,"wires":[["aeccccbe.c3651"]]},{"id":"3238142f.bab64c","type":"sqlite","z":"3ee4a50f.d7fd0a","mydb":"a5762d7.f21efd","sqlquery":"fixed","sql":"SELECT * FROM Players;","name":"Elements on players List","x":336,"y":118,"wires":[["22d63c4a.f482f4"]]},{"id":"4fec79f9.70e158","type":"inject","z":"3ee4a50f.d7fd0a","name":"","props":[],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payloadType":"str","x":116,"y":118,"wires":[["3238142f.bab64c"]]},{"id":"d0a7d8c3.560628","type":"http in","z":"3ee4a50f.d7fd0a","name":"","url":"/addImg.php","method":"post","upload":true,"swaggerDoc":"","x":130,"y":540,"wires":[["fcfb0ba9.194ce8"]]},{"id":"b482030f.21609","type":"template","z":"3ee4a50f.d7fd0a","name":"","field":"topic","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"INSERT INTO Players ('name') values (\"{{user}}\");","output":"str","x":600,"y":360,"wires":[["32422764.0b24c8","326457be.bbc4d8"]]},{"id":"aea19364.428f5","type":"debug","z":"3ee4a50f.d7fd0a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"user","targetType":"msg","statusVal":"","statusType":"auto","x":560,"y":300,"wires":[]},{"id":"326457be.bbc4d8","type":"debug","z":"3ee4a50f.d7fd0a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"topic","targetType":"msg","statusVal":"","statusType":"auto","x":740,"y":300,"wires":[]},{"id":"787b6547.7db23c","type":"http response","z":"3ee4a50f.d7fd0a","name":"Send response","statusCode":"","headers":{},"x":1320,"y":420,"wires":[]},{"id":"bebbf5c3.e6f7c8","type":"template","z":"3ee4a50f.d7fd0a","name":"Create response for user device","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Player created: {{user}}","output":"str","x":1090,"y":420,"wires":[["787b6547.7db23c"]]},{"id":"774f65e9.5f368c","type":"template","z":"3ee4a50f.d7fd0a","name":"","field":"topic","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"UPDATE Players SET imgId = {{imgId}} WHERE name = '{{user}}';","output":"str","x":600,"y":660,"wires":[["fb454f3c.efa6c","fd20bcb.a36124"]]},{"id":"aeccccbe.c3651","type":"template","z":"3ee4a50f.d7fd0a","name":"","field":"topic","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"SELECT pId FROM Players WHERE name = '{{user}}'","output":"str","x":600,"y":420,"wires":[["171f5cd2.8a69c3","326457be.bbc4d8"]]},{"id":"991c8d.2321337","type":"change","z":"3ee4a50f.d7fd0a","name":"Save UserName as msg.user","rules":[{"t":"set","p":"user","pt":"msg","to":"payload.name","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":380,"y":360,"wires":[["aea19364.428f5","b482030f.21609"]]},{"id":"171f5cd2.8a69c3","type":"sqlite","z":"3ee4a50f.d7fd0a","mydb":"a5762d7.f21efd","sqlquery":"msg.topic","sql":"INSERT INTO Players ('name') values (\"Jorge\");","name":"Add playerName to opinion table","x":810,"y":420,"wires":[["bebbf5c3.e6f7c8"]]},{"id":"fcfb0ba9.194ce8","type":"change","z":"3ee4a50f.d7fd0a","name":"Save UserName as msg.user","rules":[{"t":"set","p":"user","pt":"msg","to":"payload.name","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":540,"wires":[["28669bc.9a6eb64","7ffcd778.3affd8"]]},{"id":"28669bc.9a6eb64","type":"debug","z":"3ee4a50f.d7fd0a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"user","targetType":"msg","statusVal":"","statusType":"auto","x":540,"y":480,"wires":[]},{"id":"7ffcd778.3affd8","type":"template","z":"3ee4a50f.d7fd0a","name":"","field":"topic","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"INSERT INTO Imgs (img) VALUES('{{payload.img}}');","output":"str","x":600,"y":540,"wires":[["f54947a0.9a6978"]]},{"id":"f54947a0.9a6978","type":"sqlite","z":"3ee4a50f.d7fd0a","mydb":"a5762d7.f21efd","sqlquery":"msg.topic","sql":"INSERT INTO Players ('name') values (\"Jorge\");","name":"Add img to database","x":780,"y":540,"wires":[["8677721.93dc99"]]},{"id":"8677721.93dc99","type":"sqlite","z":"3ee4a50f.d7fd0a","mydb":"a5762d7.f21efd","sqlquery":"fixed","sql":"SELECT imgId FROM Imgs ORDER BY imgId desc limit 1;","name":"Get imgId from new Img","x":650,"y":600,"wires":[["b906b32d.704ab"]]},{"id":"b906b32d.704ab","type":"change","z":"3ee4a50f.d7fd0a","name":"Save imgId","rules":[{"t":"set","p":"imgId","pt":"msg","to":"payload[0].imgId","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":600,"wires":[["5d1d133d.cefdfc","774f65e9.5f368c"]]},{"id":"5d1d133d.cefdfc","type":"debug","z":"3ee4a50f.d7fd0a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"imgId","targetType":"msg","statusVal":"","statusType":"auto","x":1030,"y":480,"wires":[]},{"id":"22d63c4a.f482f4","type":"debug","z":"3ee4a50f.d7fd0a","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":536,"y":178,"wires":[]},{"id":"c6dd8369.83d07","type":"sqlite","z":"3ee4a50f.d7fd0a","mydb":"a5762d7.f21efd","sqlquery":"fixed","sql":"SELECT * FROM Imgs;","name":"Elements on Imgs List","x":326,"y":178,"wires":[["22d63c4a.f482f4"]]},{"id":"89c682dc.10d91","type":"inject","z":"3ee4a50f.d7fd0a","name":"","props":[],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":116,"y":178,"wires":[["c6dd8369.83d07"]]},{"id":"ef757fa9.1b623","type":"sqlite","z":"3ee4a50f.d7fd0a","mydb":"a5762d7.f21efd","sqlquery":"fixed","sql":"SELECT * FROM Opinion;","name":"Elements on Opinion List","x":336,"y":238,"wires":[["22d63c4a.f482f4"]]},{"id":"75fcac30.a40d84","type":"inject","z":"3ee4a50f.d7fd0a","name":"","props":[],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","x":116,"y":238,"wires":[["ef757fa9.1b623"]]},{"id":"e7ed17ba.a6a948","type":"sqlite","z":"3ee4a50f.d7fd0a","mydb":"a5762d7.f21efd","sqlquery":"fixed","sql":"CREATE TABLE 'Imgs' (\n\t'imgId' INTEGER PRIMARY KEY AUTOINCREMENT,\n\t'img' BLOB NOT NULL\n);","name":"Create Imgs table","x":516,"y":58,"wires":[["695efddd.b56fb4"]]},{"id":"695efddd.b56fb4","type":"sqlite","z":"3ee4a50f.d7fd0a","mydb":"a5762d7.f21efd","sqlquery":"fixed","sql":"CREATE TABLE 'Opinion' (\n\t'pId' INTEGER PRIMARY KEY,\n\t'val' INTEGER DEFAULT 0\n);","name":"Create Opinion table","x":726,"y":58,"wires":[[]]},{"id":"fb454f3c.efa6c","type":"sqlite","z":"3ee4a50f.d7fd0a","mydb":"a5762d7.f21efd","sqlquery":"fixed","sql":"SELECT imgId FROM Imgs ORDER BY imgId desc limit 1;","name":"Update imgId on Players table","x":810,"y":660,"wires":[["f47c840c.f85e88"]]},{"id":"f47c840c.f85e88","type":"template","z":"3ee4a50f.d7fd0a","name":"Create response for user device","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Img stored and linked","output":"str","x":1090,"y":660,"wires":[["6a7be78a.149938"]]},{"id":"6a7be78a.149938","type":"http response","z":"3ee4a50f.d7fd0a","name":"Send response","statusCode":"","headers":{},"x":1320,"y":660,"wires":[]},{"id":"fd20bcb.a36124","type":"debug","z":"3ee4a50f.d7fd0a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"topic","targetType":"msg","statusVal":"","statusType":"auto","x":720,"y":700,"wires":[]},{"id":"a5762d7.f21efd","type":"sqlitedb","db":":memory:","mode":"RWC"}]